<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aventura Interactiva - Dashboard Editor</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/editor.css">
    <link rel="stylesheet" href="css/notifications.css">
</head>
<body>

    <!-- Left Sidebar: Scene Management -->
    <div id="sidebar-left">
        <!-- Project Selector -->
        <div class="project-header">
            <h3 id="current-project-name">Sin proyecto</h3>
            <button id="btn-manage-projects" class="icon-button" title="Gestionar Proyectos"></button>
        </div>
        
        <h3>Escenas</h3>
        <select id="scene-selector" size="5" style="height: 150px; margin-bottom: 10px;"></select>
        <div style="display: flex; gap: 5px;">
            <button id="btn-add-scene" style="flex: 1;">Nueva Escena</button>
            <button id="btn-delete-scene" class="danger" style="flex: 1;">Eliminar</button>
        </div>
        
        <div id="scene-properties" class="control-group" style="display:none;">
            <label>ID Escena:</label>
            <input type="text" id="scene-id" readonly>
            <label>T铆tulo:</label>
            <input type="text" id="scene-title">
            <label>Color Fondo:</label>
            <input type="color" id="scene-bg-color">
        </div>

        <div class="control-group">
            <button id="btn-export-json" class="secondary">Ver/Exportar JSON</button>
            <button id="btn-save-manual" class="secondary"> Guardar Ahora</button>
            <button id="btn-clear-autosave" class="danger" style="font-size: 12px;">Limpiar Auto-guardado</button>
        </div>
    </div>

    <!-- Main Area: Stage -->
    <div id="main-area">
        <div id="stage-container">
            <!-- Dynamic Content Here -->
        </div>
        <div style="color: #ccc; margin-top: 10px;">
            Arrastra los elementos para posicionarlos.
        </div>
    </div>

    <!-- Right Sidebar: Sprites & Actions -->
    <div id="sidebar-right">
        
        <!-- Backgrounds Section -->
        <h3>Fondos de Escena</h3>
        <div class="control-group">
            <div id="background-list"></div>
            <button id="btn-add-background" class="secondary" style="margin-top:5px; width: 100%;">+ A帽adir Fondo</button>
            <button id="btn-delete-background" class="danger" style="margin-top:5px; width: 100%;">- Eliminar Fondo</button>
            <input type="file" id="background-file-input" accept="image/*" style="display: none;">
        </div>

        <div id="background-properties" class="control-group" style="display:none;">
            <h4 style="margin-top: 0;">Propiedades del Fondo</h4>
            
            <label>Nombre:</label>
            <input type="text" id="background-name" placeholder="Nombre del fondo">
            
            <label>Archivo:</label>
            <div style="display: flex; gap: 5px;">
                <input type="text" id="background-src" placeholder="Ruta" readonly style="flex: 1;">
                <button id="btn-upload-background" class="secondary" style="padding: 5px 10px;"></button>
            </div>
            <input type="file" id="background-update-input" accept="image/*" style="display: none;">
            
            <hr style="margin: 15px 0; border: none; border-top: 1px solid #ddd;">
            
            <h4>Visualizaci贸n Base</h4>
            <label>Modo de Relleno:</label>
            <select id="bg-fill">
                <option value="cover">Cubrir (cover)</option>
                <option value="contain">Contener (contain)</option>
                <option value="stretch">Estirar (stretch)</option>
                <option value="repeat">Repetir (repeat)</option>
                <option value="no-repeat">No Repetir</option>
            </select>
            
            <hr style="margin: 15px 0; border: none; border-top: 1px solid #ddd;">
            
            <h4>Comportamiento / Animaci贸n</h4>
            <label>Tipo:</label>
            <select id="bg-effect-type">
                <option value="static">Est谩tico (sin animaci贸n)</option>
                <option value="fade-in">Fade In (aparecer)</option>
                <option value="fade-out">Fade Out (desaparecer)</option>
                <option value="slide">Deslizar (custom)</option>
                <option value="zoom-in">Zoom In</option>
                <option value="zoom-out">Zoom Out</option>
                <option value="parallax">Parallax (scroll)</option>
            </select>
            
            <!-- Opciones para STATIC -->
            <div id="static-options" class="effect-options" style="display: none; margin-top: 10px;">
                <h5 style="margin: 10px 0 5px; color: #666;">Posici贸n Fija</h5>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div>
                        <label>X:</label>
                        <input type="text" id="static-pos-x" placeholder="center" title="center, left, right, 0px, 50%">
                    </div>
                    <div>
                        <label>Y:</label>
                        <input type="text" id="static-pos-y" placeholder="center" title="center, top, bottom, 0px, 50%">
                    </div>
                </div>
                <label>Opacidad:</label>
                <input type="range" id="static-opacity" min="0" max="1" step="0.1" value="1" style="width: 100%;">
                <span id="static-opacity-value" style="font-size: 12px; color: #666;">100%</span>
            </div>
            
            <!-- Opciones para FADE IN/OUT -->
            <div id="fade-options" class="effect-options" style="display: none; margin-top: 10px;">
                <h5 style="margin: 10px 0 5px; color: #666;">Configuraci贸n Fade</h5>
                <label>Opacidad Inicial:</label>
                <input type="range" id="fade-opacity-start" min="0" max="1" step="0.1" value="0" style="width: 100%;">
                <span id="fade-opacity-start-value" style="font-size: 12px; color: #666;">0%</span>
                
                <label>Opacidad Final:</label>
                <input type="range" id="fade-opacity-end" min="0" max="1" step="0.1" value="1" style="width: 100%;">
                <span id="fade-opacity-end-value" style="font-size: 12px; color: #666;">100%</span>
                
                <label>Duraci贸n (segundos):</label>
                <input type="number" id="fade-duration" min="0.1" max="10" step="0.1" value="1">
                
                <label>Retraso (segundos):</label>
                <input type="number" id="fade-delay" min="0" max="10" step="0.1" value="0">
                
                <label>Easing:</label>
                <select id="fade-easing">
                    <option value="linear">Lineal</option>
                    <option value="ease">Ease</option>
                    <option value="ease-in">Ease In</option>
                    <option value="ease-out">Ease Out</option>
                    <option value="ease-in-out">Ease In-Out</option>
                </select>
            </div>
            
            <!-- Opciones para SLIDE -->
            <div id="slide-options" class="effect-options" style="display: none; margin-top: 10px;">
                <h5 style="margin: 10px 0 5px; color: #666;">Configuraci贸n Deslizamiento</h5>
                <label>Posici贸n Inicial:</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <div>
                        <label style="font-size: 11px;">X inicio:</label>
                        <input type="text" id="slide-start-x" placeholder="-100%" title="Ej: -100%, 0px, 100vw">
                    </div>
                    <div>
                        <label style="font-size: 11px;">Y inicio:</label>
                        <input type="text" id="slide-start-y" placeholder="0%" title="Ej: -100%, 0px, 100vh">
                    </div>
                </div>
                
                <label>Posici贸n Final:</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <div>
                        <label style="font-size: 11px;">X final:</label>
                        <input type="text" id="slide-end-x" placeholder="0%" title="Ej: 0%, 50%, center">
                    </div>
                    <div>
                        <label style="font-size: 11px;">Y final:</label>
                        <input type="text" id="slide-end-y" placeholder="0%" title="Ej: 0%, 50%, center">
                    </div>
                </div>
                
                <label>Duraci贸n (segundos):</label>
                <input type="number" id="slide-duration" min="0.1" max="10" step="0.1" value="1">
                
                <label>Retraso (segundos):</label>
                <input type="number" id="slide-delay" min="0" max="10" step="0.1" value="0">
                
                <label>Easing:</label>
                <select id="slide-easing">
                    <option value="linear">Lineal</option>
                    <option value="ease">Ease</option>
                    <option value="ease-in">Ease In</option>
                    <option value="ease-out">Ease Out</option>
                    <option value="ease-in-out">Ease In-Out</option>
                </select>
            </div>
            
            <!-- Opciones para ZOOM -->
            <div id="zoom-options" class="effect-options" style="display: none; margin-top: 10px;">
                <h5 style="margin: 10px 0 5px; color: #666;">Configuraci贸n Zoom</h5>
                <label>Escala Inicial:</label>
                <input type="range" id="zoom-scale-start" min="0" max="3" step="0.1" value="0" style="width: 100%;">
                <span id="zoom-scale-start-value" style="font-size: 12px; color: #666;">0x</span>
                
                <label>Escala Final:</label>
                <input type="range" id="zoom-scale-end" min="0" max="3" step="0.1" value="1" style="width: 100%;">
                <span id="zoom-scale-end-value" style="font-size: 12px; color: #666;">1x</span>
                
                <label>Punto de Origen:</label>
                <select id="zoom-origin">
                    <option value="center">Centro</option>
                    <option value="top left">Arriba Izquierda</option>
                    <option value="top right">Arriba Derecha</option>
                    <option value="bottom left">Abajo Izquierda</option>
                    <option value="bottom right">Abajo Derecha</option>
                </select>
                
                <label>Duraci贸n (segundos):</label>
                <input type="number" id="zoom-duration" min="0.1" max="10" step="0.1" value="1">
                
                <label>Retraso (segundos):</label>
                <input type="number" id="zoom-delay" min="0" max="10" step="0.1" value="0">
                
                <label>Easing:</label>
                <select id="zoom-easing">
                    <option value="linear">Lineal</option>
                    <option value="ease">Ease</option>
                    <option value="ease-in">Ease In</option>
                    <option value="ease-out">Ease Out</option>
                    <option value="ease-in-out">Ease In-Out</option>
                </select>
            </div>
            
            <!-- Opciones para PARALLAX -->
            <div id="parallax-options" class="effect-options" style="display: none; margin-top: 10px;">
                <h5 style="margin: 10px 0 5px; color: #666;">Configuraci贸n Parallax</h5>
                <label>Velocidad de Desplazamiento:</label>
                <input type="range" id="parallax-speed" min="0.1" max="2" step="0.1" value="0.5" style="width: 100%;">
                <span id="parallax-speed-value" style="font-size: 12px; color: #666;">0.5x</span>
                <small style="display: block; color: #999; margin-top: 5px;">
                    Menor a 1: m谩s lento (fondo lejano)<br>
                    Mayor a 1: m谩s r谩pido (primer plano)
                </small>
                
                <label>Direcci贸n:</label>
                <select id="parallax-direction">
                    <option value="vertical">Vertical (scroll)</option>
                    <option value="horizontal">Horizontal</option>
                    <option value="both">Ambas</option>
                </select>
            </div>
            
            <button id="btn-save-background" style="margin-top: 15px; width: 100%;"> Guardar Cambios</button>
        </div>
        
        <!-- Content Section -->
        <h3>Contenido de Texto</h3>
        <div class="control-group">
            <label>Texto:</label>
            <textarea id="scene-text" rows="3" placeholder="Texto que aparecer谩 en la escena"></textarea>
            <label>Posici贸n:</label>
            <select id="scene-layout">
                <option value="center">Centro</option>
                <option value="top">Arriba</option>
                <option value="bottom">Abajo</option>
            </select>
        </div>
        
        <!-- Sprites Section -->
        <h3>Sprites</h3>
        <div class="control-group">
            <div id="sprite-list"></div>
            <button id="btn-add-sprite" class="secondary" style="margin-top:5px;">+ A帽adir Sprite</button>
        </div>

        <div id="sprite-properties" class="control-group" style="display:none;">
            <label>Nombre del Sprite:</label>
            <input type="text" id="sprite-name" placeholder="Nombre del sprite">
            <label>Archivo de Imagen:</label>
            <div style="display: flex; gap: 5px;">
                <input type="text" id="sprite-src" placeholder="Ruta imagen" readonly style="flex: 1;">
                <button id="btn-upload-sprite" class="secondary" style="padding: 5px 10px;"> Subir</button>
            </div>
            <input type="file" id="sprite-file-input" accept="image/*" style="display: none;">
            <label>Tama帽o:</label>
            <input type="text" id="sprite-size" placeholder="ej: 10%">
            
            <hr>
            <label>Posiciones Guardadas:</label>
            <div id="sprite-positions-list" style="max-height: 100px; overflow-y: auto; margin-bottom: 5px;"></div>
            
            <button id="btn-save-sprite-pos">Guardar Posici贸n Actual</button>
            <small style="display:block; color: #666; margin-bottom: 5px;">Arrastra el sprite en el escenario y pulsa guardar para a帽adir una nueva posici贸n.</small>
        </div>

        <!-- Actions/Buttons Section -->
        <h3>Botones / Acciones</h3>
        <div class="control-group">
            <div id="action-list"></div>
            <button id="btn-add-button" class="secondary" style="margin-top:5px;">+ A帽adir Bot贸n</button>
        </div>

        <div id="action-properties" class="control-group" style="display:none;">
            <label>Etiqueta Bot贸n:</label>
            <input type="text" id="action-label">
            <label>Tipo Acci贸n:</label>
            <select id="action-type">
                <option value="button">Bot贸n (Cambio Escena)</option>
                <option value="sprite-move">Mover Sprite</option>
            </select>
            
            <div id="target-scene-group">
                <label>Target (ID Escena):</label>
                <input type="number" id="action-target-scene">
            </div>

            <div id="target-sprite-group" style="display:none;">
                <label>Target (ID Sprite):</label>
                <input type="text" id="action-target-sprite" placeholder="ej: sprites1">
                <label>Siguiente Posici贸n (ID):</label>
                <input type="number" id="action-next-pos">
            </div>

            <button id="btn-delete-action" class="danger">Eliminar Bot贸n</button>
        </div>

        <!-- Time Events -->
        <h3>Eventos de Tiempo</h3>
        <div class="control-group">
            <div id="time-event-list"></div>
            <button id="btn-add-time-event" class="secondary">+ A帽adir Evento Tiempo</button>
        </div>

    </div>

    <!-- JSON Export Modal -->
    <div id="json-output-modal">
        <div id="json-output-content">
            <h3>JSON Generado</h3>
            <textarea id="json-textarea"></textarea>
            <div style="margin-top: 10px; text-align: right;">
                <button onclick="$('#json-output-modal').hide()" style="width: auto;">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Project Management Modal -->
    <div id="project-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Gesti贸n de Proyectos</h2>
                <button class="close-modal" onclick="$('#project-modal').hide()"></button>
            </div>
            
            <div class="modal-body">
                <!-- Project List -->
                <div class="project-list-container">
                    <h3>Proyectos Existentes</h3>
                    <div id="project-list" class="project-list">
                        <!-- Projects will be dynamically loaded here -->
                    </div>
                </div>

                <!-- Create New Project -->
                <div class="project-form-container">
                    <h3>Crear Nuevo Proyecto</h3>
                    <form id="new-project-form">
                        <div class="form-group">
                            <label for="new-project-name">Nombre del Proyecto:</label>
                            <input type="text" id="new-project-name" required placeholder="Mi Aventura">
                        </div>
                        <div class="form-group">
                            <label for="new-project-description">Descripci贸n:</label>
                            <textarea id="new-project-description" rows="3" placeholder="Descripci贸n del proyecto..."></textarea>
                        </div>
                        <button type="submit" class="btn-primary">Crear Proyecto</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

<script src="js/logger.js"></script>
<script src="js/error-handler.js"></script>
<script src="js/notifications.js"></script>
<script src="js/project-manager.js"></script>
<script src="js/auto-save.js"></script>
<script src="js/editor.js"></script>

</body>
</html>
